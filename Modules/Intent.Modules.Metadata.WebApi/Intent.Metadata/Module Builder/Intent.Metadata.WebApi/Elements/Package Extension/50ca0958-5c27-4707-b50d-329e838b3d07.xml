<?xml version="1.0" encoding="utf-8"?>
<class id="50ca0958-5c27-4707-b50d-329e838b3d07" type="Package Extension" typeId="ab4152df-3add-4a08-81b6-0fefc7cbb204">
  <name>Package Extension</name>
  <display>Package Extension: Services Package</display>
  <isAbstract>false</isAbstract>
  <sort-children>by-type-then-by-name</sort-children>
  <genericTypes />
  <typeReference id="f20f59b0-0184-4afd-9d45-376a82ead880">
    <typeId>df45eaf6-9202-4c25-8dd5-677e9ba1e906</typeId>
    <isNavigable>true</isNavigable>
    <isNullable>false</isNullable>
    <isCollection>false</isCollection>
    <isRequired>true</isRequired>
    <typePackageName>Intent.Modelers.Services</typePackageName>
    <typePackageId>4ba53041-59f9-4446-a207-6da4fbdf86fe</typePackageId>
    <stereotypes />
    <genericTypeParameters />
  </typeReference>
  <isMapped>false</isMapped>
  <parentFolderId>03bfccb7-d845-411f-ba08-4fddb01bbbda</parentFolderId>
  <packageId>0011387a-b122-45d7-9cdb-8e21b315ab9f</packageId>
  <packageName>Intent.Metadata.WebApi</packageName>
  <stereotypes />
  <metadata />
  <childElements>
    <childElement id="8fe7acb3-7ce9-4611-bc96-d70e72e5993e" type="Context Menu" typeId="d45e383d-90ba-4b64-aca7-34ca100cea21">
      <name>[context menu]</name>
      <display>[context menu]</display>
      <isAbstract>false</isAbstract>
      <genericTypes />
      <isMapped>false</isMapped>
      <parentFolderId>50ca0958-5c27-4707-b50d-329e838b3d07</parentFolderId>
      <packageId>0011387a-b122-45d7-9cdb-8e21b315ab9f</packageId>
      <packageName>Intent.Metadata.WebApi</packageName>
      <stereotypes />
      <metadata />
      <childElements />
    </childElement>
    <childElement id="80cefa13-c09d-4086-9f67-185497b26b5b" type="Package Event Settings" typeId="48bcdd5f-690c-425b-8f5e-99097a7188dc">
      <name>NewPackageEventSettings</name>
      <display>[events]</display>
      <isAbstract>false</isAbstract>
      <sort-children>by-type-then-by-name</sort-children>
      <genericTypes />
      <isMapped>false</isMapped>
      <parentFolderId>50ca0958-5c27-4707-b50d-329e838b3d07</parentFolderId>
      <packageId>0011387a-b122-45d7-9cdb-8e21b315ab9f</packageId>
      <packageName>Intent.Metadata.WebApi</packageName>
      <stereotypes />
      <metadata />
      <childElements>
        <childElement id="f57cccdb-c23b-42f4-88fa-4cf4475423f5" type="Element Event Handler" typeId="0ef412e3-d15a-45d3-bcd3-f646165f2eb6">
          <name>On Loaded</name>
          <display>On Loaded: Script</display>
          <isAbstract>false</isAbstract>
          <genericTypes />
          <typeReference id="12743e0f-cffb-469f-8c91-5de97917b718">
            <typeId>043eee26-1591-42ac-9f2c-fc911b070eb1</typeId>
            <isNavigable>true</isNavigable>
            <isNullable>false</isNullable>
            <isCollection>false</isCollection>
            <isRequired>true</isRequired>
            <typePackageName>Intent.ModuleBuilder</typePackageName>
            <typePackageId>9972b2a9-b749-4bba-b5c8-824bf694c6ef</typePackageId>
            <stereotypes />
            <genericTypeParameters />
          </typeReference>
          <isMapped>false</isMapped>
          <parentFolderId>80cefa13-c09d-4086-9f67-185497b26b5b</parentFolderId>
          <packageId>0011387a-b122-45d7-9cdb-8e21b315ab9f</packageId>
          <packageName>Intent.Metadata.WebApi</packageName>
          <stereotypes>
            <stereotype stereotypeDefinitionId="56bc0465-c1fe-4bca-9493-2a3ce88a4047" name="Script Settings">
              <addedByDefault>true</addedByDefault>
              <definitionPackageName>Intent.ModuleBuilder</definitionPackageName>
              <definitionPackageId>9972b2a9-b749-4bba-b5c8-824bf694c6ef</definitionPackageId>
              <properties>
                <property name="73a4088f-626e-4d31-b0b2-113167f015b2" display="Script" value="let services = lookupTypesOf(&quot;Service&quot;).filter(x =&gt; x.hasStereotype(&quot;Http Service Settings&quot;));&#xD;&#xA;if (services.length == 0 || services.filter(x =&gt; x.getChildren(&quot;Operation&quot;)&#xD;&#xA;    .some(x =&gt; x.isMapped &amp;&amp; (x.getMapping()?.getElement()?.specialization == &quot;Command&quot; || x.getMapping()?.getElement()?.specialization == &quot;Query&quot;)))&#xD;&#xA;    .length == 0) {&#xD;&#xA;    return;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;await dialogService.info(`The Intent.Modules.AspNetCore.Dispatch.MediatR major release (5.0.0) requires that a migration be run against this metadata.&#xD;&#xA;&#xD;&#xA;This migration will remove all Services that have been mapped to Commands and Queries and apply the equivalent Http Settings directly onto the Commands and Queries.&#xD;&#xA;&#xD;&#xA;This new approach simplifies the metadata and conforms better to the application oriented design paradigm than with the Services. It also allows Services to take the role of application services instead of assuming that they are AspNetCore controllers.&#xD;&#xA;&#xD;&#xA;Note that the software factory will make changes to all controllers (e.g. renaming methods). However, there should be no changes in the HTTP Web API itself and therefore should require no changes on any consuming clients. &#xD;&#xA;&#xD;&#xA;If you run into any issues, please revert your changes and contact our support team via support@intentarchitect.com or your preferred channel`);&#xD;&#xA;&#xD;&#xA;let httpSettingsId = &quot;389e3ad2-6063-4777-aa47-5ec9421faf3d&quot;;&#xD;&#xA;services.forEach(service =&gt; {&#xD;&#xA;    let serviceRoute = service.getStereotype(&quot;Http Service Settings&quot;).getProperty(&quot;Route&quot;).getValue();&#xD;&#xA;    if (serviceRoute == null || serviceRoute == &quot;&quot;) {&#xD;&#xA;        serviceRoute = `api/${toKebabCase(removeSuffix(service.getName(), &quot;Service&quot;, &quot;Controller&quot;))}`;&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    let operations = service.getChildren(&quot;Operation&quot;).filter(x =&gt; x.hasStereotype(&quot;Http Settings&quot;) &amp;&amp; x.isMapped)&#xD;&#xA;&#xD;&#xA;    operations.forEach(o =&gt; {&#xD;&#xA;        let request = o.getMapping().getElement();&#xD;&#xA;        request.addStereotype(httpSettingsId);&#xD;&#xA;        let httpSettings = request.getStereotype(httpSettingsId);&#xD;&#xA;        let operationRoute = o.getStereotype(&quot;Http Settings&quot;).getProperty(&quot;Route&quot;).getValue();&#xD;&#xA;&#xD;&#xA;        httpSettings.getProperty(&quot;Verb&quot;).setValue(o.getStereotype(&quot;Http Settings&quot;).getProperty(&quot;Verb&quot;).getValue());&#xD;&#xA;        httpSettings.getProperty(&quot;Route&quot;).setValue(`${serviceRoute}${(operationRoute == null || operationRoute == &quot;&quot; ? &quot;&quot; : `/${operationRoute}`)}`);&#xD;&#xA;        httpSettings.getProperty(&quot;Return Type Mediatype&quot;).setValue(o.getStereotype(&quot;Http Settings&quot;).getProperty(&quot;Return Type Mediatype&quot;).getValue());&#xD;&#xA;    });&#xD;&#xA;&#xD;&#xA;    if (operations.length &gt; 0) {&#xD;&#xA;        service.delete();&#xD;&#xA;    }&#xD;&#xA;})" isActive="true" />
              </properties>
            </stereotype>
          </stereotypes>
          <metadata />
          <childElements />
        </childElement>
      </childElements>
    </childElement>
  </childElements>
</class>